<!--TODO: create a component to edit each shift on its own-->

<div class="row">

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <h3>
      Edit Sessions
    </h3>

  </div>
</div>

<div class="row">

  <!--Session name, notes-->
  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

    <!--Session name-->
    <div class="form-group">
      <input type="text" name="session-name" [(ngModel)]="session.name" class="form-control" placeholder="Name">
    </div>

    <div class="form-group">

      <div [ngSwitch]="this.shifts?.length>0">
        <div *ngSwitchCase="true">


          <div class="btn-group" dropdown>
            <button id="single-button" type="button" class="btn btn-default" dropdownToggle>
                {{this.shiftIndex>=0? ('Shift #'+this.shifts[shiftIndex]?.number):"Select Shift"}} <span class="caret"></span>
            </button>
            <ul dropdownMenu role="menu" aria-labelledby="single-button">
              <ng-container *ngFor="let shiftItem of shifts;let i = index">
                <li role="menuitem"><a class="dropdown-item" (click)="onShiftSelect(i)">{{shiftItem.number}}</a></li>
              </ng-container>
            </ul>
          </div>
        </div>


        <div *ngSwitchDefault>
          <strong class="text-danger">Please add shifts</strong>
        </div>

      </div>


    </div>
    <!--Session notes-->
    <div class="form-group">
      <textarea rows="3" class="form-control" placeholder="Notes" [(ngModel)]="session.notes"></textarea>
    </div>

    <div class="form-group">
      <button type="button" (click)="addSession()" class="btn btn-default">Add Session</button>
    </div>

  </div>
  <!--End session name, notes-->

  <!--Session time-->
  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

    <div class="row">
      <!--Session time from -->
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">

        <label for="_start">From</label>
        <timepicker [(ngModel)]="session.startDate" name="_start"></timepicker>


      </div>

      <!--Session time to-->
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
        <label for="_end">To</label>
        <timepicker [(ngModel)]="session.endDate" name="_end"></timepicker>

      </div>

    </div>

  </div>
  <!--End session time-->


  <!--Show Error-->
  <div class="row">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      <div *ngIf="error" class="container">
        <div class="alert alert-danger">
          <strong>Please note!</strong>
          <ng-container *ngIf="error===1">
            <p>Session end time is less than or equal to its start time
            </p>
          </ng-container>

          <ng-container *ngIf="error===2">
            <p>Session name is required
            </p>
          </ng-container>
          <ng-container *ngIf="error===3">
            <p>Shift isn't selected
            </p>
          </ng-container>
        </div>
      </div>
    </div>

  </div>

</div>

<div class="form-group">
  <accordion>
    <accordion-group #group>
      <div accordion-heading>
        <strong>
        {{this.daySessionCount}} Session{{this.daySessionCount!=1?"s":""}} </strong>
        <i class="pull-right float-xs-right glyphicon" [ngClass]="{'glyphicon-chevron-down': group?.isOpen, 'glyphicon-chevron-right': !group?.isOpen}"></i>
      </div>

      <!--Day session details table-->
      <ng-container *ngIf="this.shifts"></ng-container>
      <table class="table table-stipped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Start</th>
            <th>End</th>
            <th>ShiftNumber</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let shiftIter of shifts;let shiftIdx=index">
            <ng-container *ngFor="let session of shiftIter.sessions;let sessionIdx=index">
              <tr>
                <td>{{session.name}}</td>
                <td>{{session.startDate|date:'shortTime'}}</td>
                <td>{{session.endDate|date:'shortTime'}}</td>
                <td>{{shiftIter.number}}</td>
                <td>
                  <button (click)="onSessionRemove(shiftIdx,sessionIdx)" class="btn btn-default">
            <span class="glyphicon glyphicon-remove red" aria-hidden="true"></span>
          </button>
                </td>
              </tr>
            </ng-container>
          </ng-container>
        </tbody>
      </table>

    </accordion-group>
  </accordion>
</div>